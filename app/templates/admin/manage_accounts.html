{% extends "base.html" %}
{% block title %}Manage Accounts{% endblock %}

{% block content %}
<div x-data="{ sidebarOpen: false, email: '', password: '', role: 'user', message: '' }" class="flex h-screen bg-gray-100">
  
  <!-- Sidebar (same as dashboard) -->
  <aside :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'"
         class="fixed inset-y-0 left-0 w-64 bg-white shadow-md transform transition-transform duration-300 md:translate-x-0 md:static md:inset-0 z-20">
    <div class="p-6 flex flex-col h-full">
      <h2 class="text-2xl font-bold text-green-700 mb-6">Admin Panel</h2>
      <nav class="flex-1 space-y-2">
        <a href="/dashboard" class="block px-4 py-2 rounded hover:bg-green-100">Dashboard</a>
        <a href="/dashboard/manage_accounts" class="block px-4 py-2 rounded hover:bg-green-100">Manage Accounts</a>
        <a href="/dashboard/online_sheets" class="block px-4 py-2 rounded hover:bg-green-100">Online Sheets</a>
      </nav>
      <a href="/auth/logout" class="mt-auto block px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 text-center">Logout</a>
    </div>
  </aside>

  <!-- Main content -->
  <div class="flex-1 flex flex-col overflow-auto p-6">
    <h1 class="text-3xl font-bold mb-4">Manage Accounts</h1>

    <!-- Add User Form -->
    <form @submit.prevent="
      fetch('/dashboard/manage_accounts/add_user', {
        method: 'POST',
        body: new FormData($event.target)
      })
      .then(res => res.json())
      .then(data => message = data.detail)
      .catch(err => message = err)
    " class="mb-6 bg-white p-4 rounded shadow space-y-3">
      <input type="email" name="email" placeholder="Email" class="w-full border p-2 rounded" x-model="email" required>
      <input type="password" name="password" placeholder="Password" class="w-full border p-2 rounded" x-model="password" required>
      <select name="role" x-model="role" class="w-full border p-2 rounded">
        <option value="user">User</option>
        <option value="developer">Developer</option>
      </select>
      <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Add User</button>
      <p class="text-green-600" x-text="message"></p>
    </form>

    <!-- Existing Users -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {% for u in users %}
      <div class="bg-white p-4 rounded shadow">
        <p><strong>Email:</strong> {{ u.email }}</p>
        <p><strong>Role:</strong> {{ u.role }}</p>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
{% endblock %}
